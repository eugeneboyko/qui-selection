define(function(){function d(a,b){this.__selectionLimit=a||Number.POSITIVE_INFINITY;this.__allItems=b||[];this.__selectedItems=[]}d.prototype={allocate:function(a){return this.deselect(this.firstSelected())},select:function(a){if(1>this.__selectionLimit||-1!==this.__selectedItems.indexOf(a)||this.__selectedItems.length>=this.__selectionLimit&&!this.allocate(a))return!1;this.__selectedItems.push(a);this.callback&&this.callback(a,!0);return!0},deselect:function(a){var b=this.__selectedItems.indexOf(a);
if(-1===b)return!1;this.__selectedItems.splice(b,1);this.callback&&this.callback(a,!1);return!0},isSelected:function(a){return-1!==this.__selectedItems.indexOf(a)},toggle:function(a){this.isSelected(a)?this.deselect(a):this.select(a)},selectItems:function(a){for(var b=0;b<a.length;b++)this.select(a)},deselectItems:function(a){for(var b=0;b<a.length;b++)this.deselect(a)},toggleItems:function(a){for(var b=0;b<a.length;b++)this.toggle(a)},isAllItemsSelected:function(a){for(var b=0;b<a.length;b++)if(!this.isSelected(a[b]))return!1;
return!0},isAnyItemSelected:function(a){for(var b=0;b<a.length;b++)if(this.isSelected(a[b]))return!0;return!1},selectAll:function(){this.selectItems(this.allItems)},deselectAll:function(){this.deselectItems(this.allItems)},toggleAll:function(){this.isAllSelected()?this.deselectAll():this.selectAll()},isAllSelected:function(){return this.__selectedItems.length===this.__allItems.length},isAnySelected:function(){return 0<this.__selectedItems.length},firstSelected:function(){return this.__selectedItems[0]}};
Object.defineProperty(d.prototype,"selectedItems",{get:function(){return this.__selectedItems},set:function(a){var b=[],c;for(c=0;c<this.__selectedItems.length;c++)-1===a.indexOf(this.__selectedItems[c])&&b.push(this.__selectedItems[c]);for(c=0;c<b.length;c++)this.deselect(b[c]);for(c=0;c<a.length;c++)this.select(a[c])}});Object.defineProperty(d.prototype,"allItems",{get:function(){return this.__allItems},set:function(a){this.deselectAll();this.__allItems=a}});Object.defineProperty(d.prototype,"selectionLimit",
{get:function(){return this.__selectionLimit},set:function(a){this.deselectAll();this.__selectionLimit=a}});return d});
